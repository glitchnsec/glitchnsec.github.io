---
layout: advisory
cve: CVE-2021-28472
vendor: Microsoft
title: Visual Studio Code Maven for Java Extension Remote Code Execution Vulnerability
cvss3: 9.6, CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H
date: 2021-08-02 23:44:18 -0500
discovered: 2021-03-17 11:58:18 -0600
products:
    - Maven for Java Extension for Visual Studio Code
advisories:
    - "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-28472"
    - "https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-28472"
author: glitchnsec
summary: A command injection due to improper validation of user input exists in the Maven for Java Extension prior to 0.29.0.
cwes:
    - id: 15
      name: External Control of System or Configuration Setting
    - id: 78
      name: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')      

---

### Description

This vulnerability is due to improper validation of `maven.executable.options` retrieved from `settings.json` when constructing a `mvn` command during extension activation.

### Fixed Versions:
- Maven for Java 0.29.0

### Disclosure Timeline

- 2021-03-15 - Vulnerability reported to ZDI
- 2021-03-17 - Vulnerability reported to vendor by ZDI
- 2021-04-13 - Coordinated public release of advisory